name: Debian otel deb package generator

on: push

jobs:
  strategy:
    matrix:
      build:
        - arch: amd64
          runs-on: buildjet-2vcpu-ubuntu-2204
        - arch: arm64
          runs-on: buildjet-2vcpu-ubuntu-2204-arm
  build-debs:
    runs-on: ${{ matrix.build.runs-on }}
    steps:
      - uses: actions/checkout@v4
      - uses: jtdor/build-deb-action@v1
        name: build-deb
        env:
          DEB_BUILD_OPTIONS: noautodbgsym
        with:
          buildpackage-opts: -us -uc -b -rfakeroot
          extra-build-deps: ca-certificates

      - name: Tag to Release
        uses: softprops/action-gh-release@v2
        #if: startsWith(github.ref, 'refs/tags/')
        with:
          files: {{ steps.artifact.outputs.value }}
